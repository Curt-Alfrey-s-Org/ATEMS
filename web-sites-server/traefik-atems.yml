# Traefik dynamic config for ATEMS
# Copy to WEBSERVER (192.168.0.105) where Traefik watches (e.g. /etc/traefik/dynamic/atems.yml)
# ATEMS on same host (105): Traefik (Docker) reaches gunicorn via host.

http:
  routers:
    atems-http:
      entrypoints: [web]
      rule: "Host(`atems.alfaquantumdynamics.com`)"
      service: atems-service
      middlewares: [redirect-https]

    atems-https:
      entrypoints: [websecure]
      rule: "Host(`atems.alfaquantumdynamics.com`)"
      service: atems-service
      tls: {}

  middlewares:
    redirect-https:
      redirectScheme:
        scheme: https
        permanent: true

  services:
    atems-service:
      loadBalancer:
        servers:
          - url: "http://192.168.0.105:5000"
        passHostHeader: true
